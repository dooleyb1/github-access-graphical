{"ast":null,"code":"module.exports = apiMethod;\n\nvar clone = require('lodash/clone');\n\nvar defaultsDeep = require('lodash/defaultsDeep');\n\nvar mapKeys = require('lodash/mapKeys');\n\nvar deprecate = require('../../deprecate');\n\nvar validate = require('./validate');\n\nfunction apiMethod(octokit, endpointDefaults, endpointParams, options, callback) {\n  // Do not alter passed options (#786)\n  options = clone(options) || {}; // lowercase header names (#760)\n\n  options.headers = mapKeys(options.headers, function (value, key) {\n    return key.toLowerCase();\n  });\n\n  if (endpointDefaults.deprecated) {\n    deprecate(endpointDefaults.deprecated);\n    delete endpointDefaults.deprecated;\n  }\n\n  var endpointOptions = defaultsDeep(options, endpointDefaults);\n  var promise = Promise.resolve(endpointOptions).then(validate.bind(null, endpointParams)).then(octokit.request);\n\n  if (callback) {\n    promise.then(callback.bind(null, null), callback);\n    return;\n  }\n\n  return promise;\n}","map":null,"metadata":{},"sourceType":"script"}